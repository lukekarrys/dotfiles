{{- $isWork := eq (substr 0 9 .chezmoi.hostname) "pieholden" -}}
{{- $isMac := eq .chezmoi.os "darwin" -}}
{{- $isCodespace := env "CODESPACES" | not | not -}}
{{- $isCi := env "CI" | not | not -}}
{{- $isPermanent := and (not $isCodespace) (not $isCi) -}}
{{- $isMain := and $isPermanent $isMac -}}
{{- $isPersonal := and $isMain (not $isWork) -}}

{{- $brewPrefix := "/usr/local" -}}
{{- if eq .chezmoi.arch "arm64" -}}
{{-   $brewPrefix = "/opt/homebrew" -}}
{{- end -}}

{{- $npmGlobal := ".config/packages/npm" -}}

umask = 0o022

[diff]
  exclude = ["scripts", "externals"]

[hooks.read-source-state.pre]
  command = ".local/data/chezmoi/pre.sh"

[data.is]
  Work = {{ $isWork }}
  Mac = {{ $isMac }}
  Codespace = {{ $isCodespace }}
  Ci = {{ $isCi }}
  Permanent = {{ $isPermanent }}
  Main = {{ $isMain }}
  Personal = {{ $isPersonal }}

[data.xdg]
  config = {{ joinPath .chezmoi.homeDir ".config" | quote }}
  cache = {{ joinPath .chezmoi.homeDir ".cache" | quote }}
  data = {{ joinPath .chezmoi.homeDir ".local/data" | quote }}
  state = {{ joinPath .chezmoi.homeDir ".local/state" | quote }}

[data.dirs]
  home = {{ .chezmoi.homeDir | quote }}
  projects = {{ joinPath .chezmoi.homeDir "projects" | quote }}
  brew = {{ $brewPrefix | quote }}
  brewBin = {{ joinPath $brewPrefix "bin" | quote }}

[data.npmGlobal]
  rel = {{ $npmGlobal | quote }}
  root = {{ joinPath .chezmoi.homeDir $npmGlobal | quote }}
  path = {{ joinPath .chezmoi.homeDir $npmGlobal "bin" | quote }}
  localNodeBin = {{ joinPath .chezmoi.homeDir $npmGlobal "node/bin" | quote }}
